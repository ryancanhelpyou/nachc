!function(a,b){"use strict";function c(a){var b={select:["rejection_notification_users","rejection_notification_from_name","rejection_notification_from_email","rejection_notification_reply_to","rejection_notification_bcc","rejection_notification_subject","rejection_notification_message","rejection_notification_gpdf","rejection_notification_autoformat"],routing:["rejection_notification_routing","rejection_notification_from_name","rejection_notification_from_email","rejection_notification_reply_to","rejection_notification_bcc","rejection_notification_subject","rejection_notification_message","rejection_notification_gpdf","rejection_notification_autoformat"]};g(b,a,!0)}function d(a){var b={select:["approval_notification_users","approval_notification_from_name","approval_notification_from_email","approval_notification_reply_to","approval_notification_bcc","approval_notification_subject","approval_notification_message","approval_notification_gpdf","approval_notification_autoformat"],routing:["approval_notification_routing","approval_notification_from_name","approval_notification_from_email","approval_notification_reply_to","approval_notification_bcc","approval_notification_subject","approval_notification_message","approval_notification_gpdf","approval_notification_autoformat"]};g(b,a,!0)}function e(a){var b={select:["workflow_notification_users\\[\\]","workflow_notification_from_name","workflow_notification_from_email","workflow_notification_reply_to","workflow_notification_bcc","workflow_notification_subject","workflow_notification_message","workflow_notification_autoformat"],routing:["workflow_notification_routing","workflow_notification_from_name","workflow_notification_from_email","workflow_notification_reply_to","workflow_notification_bcc","workflow_notification_subject","workflow_notification_message","workflow_notification_autoformat"]};g(b,a,!1)}function f(a){var b={select:["assignees\\[\\]","editable_fields\\[\\]","conditional_logic_editable_fields_enabled","unanimous_approval","assignee_policy"],routing:["routing","conditional_logic_editable_fields_enabled"]};g(b,a)}function g(a,c,d){var e=d?"#gaddon-setting-tab-field-":"#gaddon-setting-row-";b.each(a,function(a,c){b.each(c,function(a,c){b(e+c).hide()})}),b.each(a,function(a,d){c==a&&b.each(d,function(a,c){b(e+c).fadeToggle("normal")})})}function h(a){var d=b("#gaddon-setting-tab-field-rejection_notification_type");if(d.toggle(a),a){var e=d.find("input[type=radio]:checked").val();c(e),b("#gaddon-setting-tab-tab_rejection_notification i.gravityflow-tab-checked").show(),b("#gaddon-setting-tab-tab_rejection_notification i.gravityflow-tab-unchecked").hide()}else c("off"),b("#gaddon-setting-tab-tab_rejection_notification i.gravityflow-tab-checked").hide(),b("#gaddon-setting-tab-tab_rejection_notification i.gravityflow-tab-unchecked").show()}function i(a){var c=b("#gaddon-setting-tab-field-approval_notification_type");if(c.toggle(a),a){var e=c.find("input[type=radio]:checked").val();d(e),b("#gaddon-setting-tab-tab_approval_notification i.gravityflow-tab-checked").show(),b("#gaddon-setting-tab-tab_approval_notification i.gravityflow-tab-unchecked").hide()}else d("off"),b("#gaddon-setting-tab-tab_approval_notification i.gravityflow-tab-checked").hide(),b("#gaddon-setting-tab-tab_approval_notification i.gravityflow-tab-unchecked").show()}function j(a){var c=b("#gaddon-setting-row-workflow_notification_type");if(c.toggle(a),a){var d=c.find("input[type=radio]:checked").val();e(d)}else e("off")}function k(){for(var a=["routing","assignees\\[\\]","unanimous_approval","assignee_notification_from_name","assignee_notification_from_email","assignee_notification_reply_to","assignee_notification_bcc","assignee_notification_subject","assignee_notification_message","assignee_notification_autoformat","resend_assignee_email","rejection_notification_type","rejection_notification_users\\[\\]","rejection_notification_user_field","rejection_notification_routing","rejection_notification_message","rejection_notification_autoformat","approval_notification_type","approval_notification_users\\[\\]","approval_notification_user_field","approval_notification_routing","approval_notification_message","approval_notification_autoformat","workflow_notification_type","workflow_notification_users\\[\\]","workflow_notification_user_field","workflow_notification_routing","workflow_notification_from_name","workflow_notification_from_email","workflow_notification_reply_to","workflow_notification_bcc","workflow_notification_subject","workflow_notification_message","workflow_notification_autoformat","assignees\\[\\]","editable_fields\\[\\]","conditional_logic_editable_fields_enabled","highlight_editable_fields","routing","assignee_policy","assignee_notification_message"],c=0;c<a.length;c++)b("#gaddon-setting-row-"+a[c]).addClass("gravityflow_sub_setting")}function l(a,b,c,d,e,f){var g=["_gaddon_setting_workflow_notification_message","_gaddon_setting_assignee_notification_message","_gaddon_setting_approval_notification_message","_gaddon_setting_rejection_notification_message"];if(g.indexOf(b)<0)return a;var h=[];return h.push({tag:"{workflow_entry_link}",label:"Entry Link"}),h.push({tag:"{workflow_entry_url}",label:"Entry URL"}),h.push({tag:"{workflow_cancel_link}",label:"Cancel Link"}),h.push({tag:"{workflow_cancel_url}",label:"Cancel URL"}),h.push({tag:"{workflow_note}",label:"Note"}),h.push({tag:"{workflow_timeline}",label:"Timeline"}),a.gravityflow={label:"Workflow",tags:h},a}function m(a,c,d,e,f,g){var h=["_gaddon_setting_assignee_notification_message"];if(h.indexOf(c)<0)return a;var i=[];return i.push({tag:"{workflow_entry_link}",label:"Entry Link"}),i.push({tag:"{workflow_entry_url}",label:"Entry URL"}),i.push({tag:"{workflow_approve_link}",label:"Approve Link"}),i.push({tag:"{workflow_reject_link}",label:"Reject Link"}),i.push({tag:"{workflow_timeline}",label:"Timeline"}),"undefined"!=typeof a.gravityflow?a.gravityflow.tags=b.merge(a.gravityflow.tags,i):a.gravityflow={label:"Workflow",tags:i},a}function n(){var a=gravityflow_form_settings_js_strings.feedId;if(a>0){var c=ajaxurl+"?action=gravityflow_feed_message&fid="+a+"&id="+gravityflow_form_settings_js_strings.formId;b.get(c,function(a){var c=b("#save_button");c.before(a)})}}b(document).ready(function(){window.gformInitDatepicker&&gformInitDatepicker(),b("#assignees, #editable_fields, #rejection_notification_users, #approval_notification_users, #workflow_notification_users, .gravityflow-multiselect-ui").multiSelect();var g=!1,l=!1;b("form#gform-settings").submit(function(){l=!0,b("form#gform-settings").find(":input").removeAttr("disabled")}),b(":input").change(function(){g=!0}),window.onbeforeunload=function(){return g&&!l?"You have unsaved changes.":void 0};var m=b("input[name=_gaddon_setting_step_type]:checked");m.val();k();var o=b("#assignee_notification_enabled"),p=b("#gaddon-setting-tab-field-assignee_notification_message");o.click(function(){p.fadeToggle("normal"),b("#gaddon-setting-tab-field-assignee_notification_from_name").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_from_email").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_reply_to").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_bcc").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_subject").fadeToggle(),b("#gaddon-setting-tab-field-resend_assignee_email").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_gpdf").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_autoformat").fadeToggle(),b("#gaddon-setting-tab-tab_assignee_notification i.gravityflow-tab-checked").toggle(),b("#gaddon-setting-tab-tab_assignee_notification i.gravityflow-tab-unchecked").toggle()});var q=o.prop("checked");p.toggle(q),b("#gaddon-setting-tab-field-assignee_notification_from_name").toggle(q),b("#gaddon-setting-tab-field-assignee_notification_from_email").toggle(q),b("#gaddon-setting-tab-field-assignee_notification_reply_to").toggle(q),b("#gaddon-setting-tab-field-assignee_notification_bcc").toggle(q),b("#gaddon-setting-tab-field-assignee_notification_subject").toggle(q),b("#gaddon-setting-tab-field-resend_assignee_email").toggle(q),b("#gaddon-setting-tab-field-assignee_notification_gpdf").toggle(q),b("#gaddon-setting-tab-field-assignee_notification_autoformat").toggle(q),b("#gaddon-setting-tab-tab_assignee_notification i.gravityflow-tab-checked").toggle(q),b("#gaddon-setting-tab-tab_assignee_notification i.gravityflow-tab-unchecked").toggle(!q);var r=b("#rejection_notification_enabled").prop("checked");h(r),b("#rejection_notification_enabled").click(function(){h(this.checked)});var s=b("input[name=_gaddon_setting_type]:checked");f(s.val()),b("#gaddon-setting-row-type input[type=radio]").change(function(){f(this.value)}),b("#gaddon-setting-tab-field-rejection_notification_type input[type=radio]").click(function(){c(this.value)}),b("#gaddon-setting-tab-field-approval_notification_type input[type=radio]").click(function(){d(this.value)});var t=b("#approval_notification_enabled").prop("checked");i(t),b("#approval_notification_enabled").click(function(){i(this.checked)}),b("#gaddon-setting-row-workflow_notification_type input[type=radio]").click(function(){e(this.value)});var u=b("#workflow_notification_enabled").prop("checked");j(u),b("#workflow_notification_enabled").click(function(){j(this.checked)}),a.getUsersMarkup=function(a){var b,c,d,e=gf_routing_setting_strings.accounts,f='<select class="gform-routing-users '+a+'_{i}">';for(b=0;b<e.length;b++)if(d=e[b],"undefined"!=typeof d.choices){var g,h="";for(c=0;c<d.choices.length;c++)g=d.choices[c],h+='<option value="{0}">{1}</option>'.format(g.value,g.label);f+='<optgroup label="{0}">{1}</option>'.format(d.label,h)}else f+='<option value="{0}">{1}</option>'.format(d.value,d.label);return f+="</select>"};var v,w=b("#gform_routing_setting"),x=b("#routing").val(),y=x?b.parseJSON(x):null;b("#editable_fields").length>0?(y||(y=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,editable_fields:[gf_routing_setting_strings.input_fields[0].key],fieldId:"0",operator:"is",value:"",type:""}],b("#user_input_routing").val(b.toJSON(y))),v={fieldName:w.data("field_name"),fieldId:w.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:y,callbacks:{addNewTarget:function(c,d){var e=a.getUsersMarkup("assignee"),f=b("#editable_fields").clone();f.attr("name","editable_fields");b("#gform-routings tbody tr").length;return f.attr("id","editable_fields_routing_{i}"),f.attr("style",""),f.addClass("gform-routing-input-field editable_fields_{i}"),e+="</td><td>"+f[0].outerHTML},header:function(a,b){return'<thead><tr><th>Assign To</th><th>Editable Fields</th><th colspan="3">Condition</th></tr></thead>'}}}):(y||(y=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,fieldId:"0",operator:"is",value:"",type:""}],b("#routing").val(b.toJSON(y))),v={fieldName:w.data("field_name"),fieldId:w.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:y,callbacks:{addNewTarget:function(b,c){var d=a.getUsersMarkup("assignee");return d}}}),w.gfRoutingSetting(v);var z=b("#gform_user_routing_setting_rejection_notification_routing"),A=b("#rejection_notification_routing").val(),B=A?b.parseJSON(A):null;B||(B=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,fieldId:"0",operator:"is",value:"",type:""}],b("#approval_rejection_notification_routing").val(b.toJSON(B)));var C={fieldName:z.data("field_name"),fieldId:z.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:B,callbacks:{addNewTarget:function(b,c){var d=a.getUsersMarkup("assignee");return d}}};z.gfRoutingSetting(C);var D=b("#gform_user_routing_setting_approval_notification_routing"),E=b("#approval_notification_routing").val(),F=E?b.parseJSON(E):null;F||(F=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,fieldId:"0",operator:"is",value:"",type:""}],b("#approval_notification_routing").val(b.toJSON(F)));var G={fieldName:D.data("field_name"),fieldId:D.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:F,callbacks:{addNewTarget:function(b,c){var d=a.getUsersMarkup("assignee");return d}}};D.gfRoutingSetting(G);var H=b("#gform_user_routing_setting_workflow_notification_routing"),I=b("#workflow_notification_routing").val(),J=I?b.parseJSON(I):null;J||(J=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,fieldId:"0",operator:"is",value:"",type:""}],b("#workflow_notification_routing").val(b.toJSON(J)));var K={fieldName:H.data("field_name"),fieldId:H.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:J,callbacks:{addNewTarget:function(b,c){var d=a.getUsersMarkup("assignee");return d}}};H.gfRoutingSetting(K),window.gform&&gform.addFilter("gform_merge_tags",a.gravityflow_add_merge_tags),window.gformInitDatepicker&&gformInitDatepicker(),n()}),a.gravityflow_add_merge_tags=function(a,b,c,d,e,f){return e?a:(l(a,b,c,d,e,f),m(a,b,c,d,e,f),a)}}(window.GravityFlowFeedSettings=window.GravityFlowFeedSettings||{},jQuery);